<!-- The main weather page to house the statistical data and form. -->
{% extends "layout.html" %} {% block content %}
<main class="site-content">
  <!-- Form and Graph Area -->
  <div class="primary-content">
    <!-- Header -->
    <header class="site-header">
      <h1 class="headline">Weather</h1>
      <p class="subtitle">Historical Weather Charter</p>
    </header>

    <!-- Input Form -->
    <form class="form" action="{{ url_for('weather') }}" method="post">
      <input
        aria-label="Location"
        type="text"
        class="input input--text"
        name="location"
        value="{{location}}"
        placeholder="Enter location..."
      />
      <select
        aria-label="Select preset"
        class="input input--select"
        name="preset"
      >
        <option class="default-item" value="none">Or select preset</option>
        <option value="Portland, OR">Portland, OR</option>
        <option value="Tigard, OR">Tigard, OR</option>
        <option value="Stanford University">Stanford University</option>
        <option value="Tilikum Crossing Bridge">Tilikum Crossing Bridge</option>
        <option value="Hershey, Pennsylvania">Hershey, Pennsylvania</option>
      </select>
      <input type="submit" class="button" value="Get Temps" />
    </form>

    <!-- Graph Display -->
    <div class="graph-container">
      <canvas class="graph" id="weather-graph"></canvas>
    </div>
    <script>
      Chart.defaults.global.responsive = false;

      // Graph canvas from HTML
      var ctx = document.getElementById("weather-graph").getContext("2d");

      // Data and labels for Graph
      const data = {
        labels: [{% for item in graph_labels %},
                  "{{item}}"
                 {% endfor %}],
        datasets: [{
            label: "Max Temp",
            data: [{% for item in graph_maxes %},
                    {{item}}
                  {% endfor %}],
            fill: false,
            lineTension: 0.1,
            backgroundColor: "rgba(255,73,46,0.4)",
            borderColor: "rgba(255,73,46,1)",
            borderCapStyle: 'round',
            borderJoinStyle: 'miter',
            pointBorderColor: "rgba(255,192,192,1)",
            pointBackgroundColor: "#ffffff",
            pointBorderWidth: 1,
            pointHoverRadius: 5,
            pointHoverBackgroundColor: "rgba(255,73,46,1)",
            pointHoverBorderColor: "rgba(220,220,220,1)",
            pointHoverBorderWidth: 2,
            pointRadius: 1,
            pointHitRadius: 12
          },{
            label: "Min Temp",
            data: [{% for item in graph_mins %},
                    {{item}}
                   {% endfor %}],
            fill: false,
            lineTension: 0.1,
            backgroundColor: "rgba(75,192,192,0.4)",
            borderColor: "rgba(75,192,192,1)",
            borderCapStyle: 'round',
            borderJoinStyle: 'miter',
            pointBorderColor: "rgba(75,192,192,1)",
            pointBackgroundColor: "#ffffff",
            pointBorderWidth: 1,
            pointHoverRadius: 5,
            pointHoverBackgroundColor: "rgba(75,192,192,1)",
            pointHoverBorderColor: "rgba(220,220,220,1)",
            pointHoverBorderWidth: 2,
            pointRadius: 2,
            pointHitRadius: 12
        }]
      };

      // Options to customize labels
      const options = {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          xAxes: [{
            display: true,
            ticks: {
              autoSkip: false,
              callback: function(label) {
                var month = label.slice(5);
                switch (month) {
                  case "01":
                    return label.slice(0,4);
                  default:
                    return "";
                }
              },
              color: 'blue',
            },
            gridLines: {
              display: false
            }
          }]
        },
      }

      // Create the graph
      var graph = new Chart(ctx, {
        type: 'line',
        data: data,
        options: options
      });
    </script>
  </div>

  <!-- Widget Area -->
  <div class="widget-container">
    <!-- Monthly Minimum Widget -->
    <section class="widget" id="month-min-widget">
      <h2 class="widget__title">{{month}}'s Min Temp</h2>
      <p class="widget__number">{{min_temp}}</p>
    </section>

    <!-- Monthly Maximum Widget -->
    <section class="widget" id="month-max-widget">
      <h2 class="widget__title">{{month}}'s Max Temp</h2>
      <p class="widget__number">{{max_temp}}</p>
    </section>

    <!-- Percent Difference from Last Year Widget -->
    <section class="widget" id="percent-widget">
      <h2 class="widget__title">% Difference from Last Year</h2>
      <p class="widget__number">{{percent}}%</p>
    </section>
  </div>

  <!-- Specific Location Information -->
  <p class="location">
    <span class="location__text">Specific located used:</span> {{address}}
  </p>

  <!-- Disclaimer About Accuracy -->
  <footer class="footer">
    <p>
      Disclaimer: the generated information above is only accurate to 5 days ago
      from use.
    </p>
  </footer>
</main>
{% endblock %}
